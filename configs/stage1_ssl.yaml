experiment: stage1_ssl_maskpuzzle
seed: 42

dataset:
  name: ptbxl
  path: data/processed/ptbxl/fs500/superclasses
  batch_size: 64
  num_workers: 4
  patch_size: 64

model:
  patch_encoder_hidden: 128
  embedding_dim: 256
  num_experts: 3
  num_permutations: 6  # 3! = 6 possible orderings
  deep_encoder: true # Tier B: ResNet-18 Backbone
  input_channels: 12 # Tier B: 12-lead input

training:
  epochs: 500
  lr: 0.0005  # Lower LR for longer run
  weight_decay: 0.001
  dropout: 0.2
  grad_clip: 1.0
  warmup_epochs: 5
  lambda_contrastive: 0.5
  contrastive_noise_std: 0.05
  contrastive_tau: 0.5

logging:
  checkpoint_dir: checkpoints/stage1_ssl
  log_interval: 50
